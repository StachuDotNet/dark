#!/usr/bin/env bash
. ./scripts/devcontainer/_assert-in-container "$0" "$@"

set -euo pipefail

grey="\033[1;30m"
reset="\033[0m"

PUBLISHED=false

for i in "$@"
do
  case "${i}" in
    --published) PUBLISHED=true ;;
  esac
done

LOG="${DARK_CONFIG_RUNDIR}/logs/packages.log"

echo -e "Loading packages ${grey}($LOG)${reset}"
if [[ "$PUBLISHED" == "true" ]]; then
  ./scripts/run-cli-internal --published ./scripts/run-package-import.dark load-packages > $LOG 2>&1
else
  ./scripts/run-cli-internal ./scripts/run-package-import.dark load-packages > $LOG 2>&1
fi
